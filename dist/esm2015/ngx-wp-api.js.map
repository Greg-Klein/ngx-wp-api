{"version":3,"file":"ngx-wp-api.js","sources":["../../../build/src/ngx-wp-api.module.ts","../../../build/src/services/wp-endpoints.service.ts","../../../build/src/services/wp-endpoint.helper.ts"],"sourcesContent":["import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { WpEndpointsService } from './services/wp-endpoints.service';\r\n\r\nexport * from './services/wp-endpoints.service';\r\n\r\n@NgModule({\r\n  imports: [CommonModule],\r\n  declarations: [],\r\n  exports: []\r\n})\r\nexport class NgxWpApiModule {\r\n  static forRoot(rootUrl: string): ModuleWithProviders {\r\n    return {\r\n      ngModule: NgxWpApiModule,\r\n      providers: [WpEndpointsService, { provide: 'rootUrl', useValue: rootUrl }]\r\n    };\r\n  }\r\n}\r\n","/**\r\n * This is the service responsible for generating Wp endpoints\r\n */\r\n\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Injectable, Inject } from '@angular/core';\r\nimport { WpEndpointHelper } from './wp-endpoint.helper';\r\n\r\n@Injectable()\r\nexport class WpEndpointsService {\r\n  private token: string;\r\n\r\n  private postEndpoint: WpEndpointHelper;\r\n  private commentEndpoint: WpEndpointHelper;\r\n  private categoryEndpoint: WpEndpointHelper;\r\n  private tagEndpoint: WpEndpointHelper;\r\n  private pageEndpoint: WpEndpointHelper;\r\n  private userEndpoint: WpEndpointHelper;\r\n  private mediaEndpoint: WpEndpointHelper;\r\n\r\n  constructor(@Inject('rootUrl') private rootUrl: string, private http: HttpClient) {}\r\n\r\n  setAuthToken(token: string) {\r\n    this.token = token;\r\n  }\r\n\r\n  posts(): WpEndpointHelper {\r\n    if (!this.postEndpoint) {\r\n      this.postEndpoint = new WpEndpointHelper(`${this.rootUrl}/wp-json/wp/v2/posts`, this.token, this.http);\r\n    }\r\n    return this.postEndpoint;\r\n  }\r\n\r\n  comments(): WpEndpointHelper {\r\n    if (!this.commentEndpoint) {\r\n      this.commentEndpoint = new WpEndpointHelper(`${this.rootUrl}/wp-json/wp/v2/comments`, this.token, this.http);\r\n    }\r\n    return this.commentEndpoint;\r\n  }\r\n\r\n  categories(): WpEndpointHelper {\r\n    if (!this.categoryEndpoint) {\r\n      this.categoryEndpoint = new WpEndpointHelper(`${this.rootUrl}/wp-json/wp/v2/categories`, this.token, this.http);\r\n    }\r\n    return this.categoryEndpoint;\r\n  }\r\n\r\n  tags(): WpEndpointHelper {\r\n    if (!this.tagEndpoint) {\r\n      this.tagEndpoint = new WpEndpointHelper(`${this.rootUrl}/wp-json/wp/v2/tags`, this.token, this.http);\r\n    }\r\n    return this.tagEndpoint;\r\n  }\r\n\r\n  pages(): WpEndpointHelper {\r\n    if (!this.pageEndpoint) {\r\n      this.pageEndpoint = new WpEndpointHelper(`${this.rootUrl}/wp-json/wp/v2/pages`, this.token, this.http);\r\n    }\r\n    return this.pageEndpoint;\r\n  }\r\n\r\n  users(): WpEndpointHelper {\r\n    if (!this.userEndpoint) {\r\n      this.userEndpoint = new WpEndpointHelper(`${this.rootUrl}/wp-json/wp/v2/users`, this.token, this.http);\r\n    }\r\n    return this.userEndpoint;\r\n  }\r\n\r\n  medias(): WpEndpointHelper {\r\n    if (!this.mediaEndpoint) {\r\n      this.mediaEndpoint = new WpEndpointHelper(`${this.rootUrl}/wp-json/wp/v2/media`, this.token, this.http);\r\n    }\r\n    return this.mediaEndpoint;\r\n  }\r\n}\r\n","/**\r\n * This is the base class for a Wp endpoint\r\n */\r\n\r\nimport { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\r\nimport { Observable } from 'rxjs/Observable';\r\nimport { Inject } from '@angular/core';\r\n\r\nexport class WpEndpointHelper {\r\n  url: string;\r\n  token: string;\r\n  options = {\r\n    headers: {},\r\n    observe: 'body',\r\n    params: new HttpParams(),\r\n    responseType: 'json'\r\n  };\r\n\r\n  constructor(endpointUrl: string, token: string, private _http: HttpClient) {\r\n    this.url = endpointUrl;\r\n    this.token = token;\r\n  }\r\n\r\n  /**\r\n   * Get a collection of elements\r\n   * @param options Request options\r\n   */\r\n  get(options: any = this.options): Observable<any> {\r\n    return this._http.get(this.url, this.getOptions(options));\r\n  }\r\n\r\n  /**\r\n   * Get a single element\r\n   * @param id Element id\r\n   * @param options Request options\r\n   */\r\n  getItem(id: number, options: any = this.options): Observable<any> {\r\n    return this._http.get(`${this.url}/${id}`, this.getOptions(options));\r\n  }\r\n\r\n  /**\r\n   * Post an element\r\n   * @param body Request body\r\n   * @param options Request options\r\n   */\r\n  post(body: any, options: any = this.options): Observable<any> {\r\n    return this._http.post(this.url, body, this.getOptions(options));\r\n  }\r\n\r\n  /**\r\n   * Update an element\r\n   * @param id Element id\r\n   * @param body Request body\r\n   * @param options Request options\r\n   */\r\n  put(id: number, body: any, options: any = this.options): Observable<any> {\r\n    return this._http.put(`${this.url}/${id}`, body, this.getOptions(options));\r\n  }\r\n\r\n  /**\r\n   * Delete an element\r\n   * @param id Element id\r\n   * @param options Request options\r\n   */\r\n  delete(id: number, options: any = this.options): Observable<any> {\r\n    options.responseType = 'text';\r\n    return this._http.delete(`${this.url}/${id}?force=true`, this.getOptions(options));\r\n  }\r\n\r\n  /* --- Utils --- */\r\n\r\n  /**\r\n   * Adds the authentication header and response formatting to the request options\r\n   * @param options Request options\r\n   */\r\n  getOptions(options: any): any {\r\n    if (this.token) {\r\n      options.headers = new HttpHeaders().set('Authorization', `Basic ${this.token}`);\r\n    }\r\n    options.observe = 'response';\r\n    return options;\r\n  }\r\n}\r\n"],"names":["http"],"mappings":"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"}